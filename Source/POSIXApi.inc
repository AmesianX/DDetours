// https://github.com/MahdiSafsafi/delphi-detours-library

{ Common Api used by POSIX systems }

const
  libc = 'c';

  { Scheduling Policies }
  SCHED_OTHER = 0;
{$EXTERNALSYM SCHED_OTHER}
  SCHED_FIFO = 1;
{$EXTERNALSYM SCHED_FIFO}
  SCHED_RR = 2;
{$EXTERNALSYM SCHED_RR}
  SCHED_BATCH = 3;
{$EXTERNALSYM SCHED_BATCH}
  { configurable system variables }
  // https://refspecs.linuxbase.org/LSB_3.0.0/LSB-PDA/LSB-PDA/libc-ddefs.html

  _SC_ARG_MAX = 0;
{$EXTERNALSYM _SC_ARG_MAX}
  _SC_CHILD_MAX = 1;
{$EXTERNALSYM _SC_CHILD_MAX}
  _SC_PRIORITY_SCHEDULING = 10;
{$EXTERNALSYM _SC_PRIORITY_SCHEDULING}
  _SC_TIMERS = 11;
{$EXTERNALSYM _SC_TIMERS}
  _SC_ASYNCHRONOUS_IO = 12;
{$EXTERNALSYM _SC_ASYNCHRONOUS_IO}
  _SC_XBS5_ILP32_OFF32 = 125;
{$EXTERNALSYM _SC_XBS5_ILP32_OFF32}
  _SC_XBS5_ILP32_OFFBIG = 126;
{$EXTERNALSYM _SC_XBS5_ILP32_OFFBIG}
  _SC_XBS5_LP64_OFF64 = 127;
{$EXTERNALSYM _SC_XBS5_LP64_OFF64}
  _SC_XBS5_LPBIG_OFFBIG = 128;
{$EXTERNALSYM _SC_XBS5_LPBIG_OFFBIG}
  _SC_XOPEN_LEGACY = 129;
{$EXTERNALSYM _SC_XOPEN_LEGACY}
  _SC_PRIORITIZED_IO = 13;
{$EXTERNALSYM _SC_PRIORITIZED_IO}
  _SC_XOPEN_REALTIME = 130;
{$EXTERNALSYM _SC_XOPEN_REALTIME}
  _SC_XOPEN_REALTIME_THREADS = 131;
{$EXTERNALSYM _SC_XOPEN_REALTIME_THREADS}
  _SC_ADVISORY_INFO = 132;
{$EXTERNALSYM _SC_ADVISORY_INFO}
  _SC_BARRIERS = 133;
{$EXTERNALSYM _SC_BARRIERS}
  _SC_CLOCK_SELECTION = 137;
{$EXTERNALSYM _SC_CLOCK_SELECTION}
  _SC_CPUTIME = 138;
{$EXTERNALSYM _SC_CPUTIME}
  _SC_THREAD_CPUTIME = 139;
{$EXTERNALSYM _SC_THREAD_CPUTIME}
  _SC_SYNCHRONIZED_IO = 14;
{$EXTERNALSYM _SC_SYNCHRONIZED_IO}
  _SC_MONOTONIC_CLOCK = 149;
{$EXTERNALSYM _SC_MONOTONIC_CLOCK}
  _SC_FSYNC = 15;
{$EXTERNALSYM _SC_FSYNC}
  _SC_READER_WRITER_LOCKS = 153;
{$EXTERNALSYM _SC_READER_WRITER_LOCKS}
  _SC_SPIN_LOCKS = 154;
{$EXTERNALSYM _SC_SPIN_LOCKS}
  _SC_REGEXP = 155;
{$EXTERNALSYM _SC_REGEXP}
  _SC_SHELL = 157;
{$EXTERNALSYM _SC_SHELL}
  _SC_SPAWN = 159;
{$EXTERNALSYM _SC_SPAWN}
  _SC_MAPPED_FILES = 16;
{$EXTERNALSYM _SC_MAPPED_FILES}
  _SC_SPORADIC_SERVER = 160;
{$EXTERNALSYM _SC_SPORADIC_SERVER}
  _SC_THREAD_SPORADIC_SERVER = 161;
{$EXTERNALSYM _SC_THREAD_SPORADIC_SERVER}
  _SC_TIMEOUTS = 164;
{$EXTERNALSYM _SC_TIMEOUTS}
  _SC_TYPED_MEMORY_OBJECTS = 165;
{$EXTERNALSYM _SC_TYPED_MEMORY_OBJECTS}
  _SC_2_PBS_ACCOUNTING = 169;
{$EXTERNALSYM _SC_2_PBS_ACCOUNTING}
  _SC_MEMLOCK = 17;
{$EXTERNALSYM _SC_MEMLOCK}
  _SC_2_PBS_LOCATE = 170;
{$EXTERNALSYM _SC_2_PBS_LOCATE}
  _SC_2_PBS_MESSAGE = 171;
{$EXTERNALSYM _SC_2_PBS_MESSAGE}
  _SC_2_PBS_TRACK = 172;
{$EXTERNALSYM _SC_2_PBS_TRACK}
  _SC_SYMLOOP_MAX = 173;
{$EXTERNALSYM _SC_SYMLOOP_MAX}
  _SC_2_PBS_CHECKPOINT = 175;
{$EXTERNALSYM _SC_2_PBS_CHECKPOINT}
  _SC_V6_ILP32_OFF32 = 176;
{$EXTERNALSYM _SC_V6_ILP32_OFF32}
  _SC_V6_ILP32_OFFBIG = 177;
{$EXTERNALSYM _SC_V6_ILP32_OFFBIG}
  _SC_V6_LP64_OFF64 = 178;
{$EXTERNALSYM _SC_V6_LP64_OFF64}
  _SC_V6_LPBIG_OFFBIG = 179;
{$EXTERNALSYM _SC_V6_LPBIG_OFFBIG}
  _SC_MEMLOCK_RANGE = 18;
{$EXTERNALSYM _SC_MEMLOCK_RANGE}
  _SC_HOST_NAME_MAX = 180;
{$EXTERNALSYM _SC_HOST_NAME_MAX}
  _SC_TRACE = 181;
{$EXTERNALSYM _SC_TRACE}
  _SC_TRACE_EVENT_FILTER = 182;
{$EXTERNALSYM _SC_TRACE_EVENT_FILTER}
  _SC_TRACE_INHERIT = 183;
{$EXTERNALSYM _SC_TRACE_INHERIT}
  _SC_TRACE_LOG = 184;
{$EXTERNALSYM _SC_TRACE_LOG}
  _SC_MEMORY_PROTECTION = 19;
{$EXTERNALSYM _SC_MEMORY_PROTECTION}
  _SC_CLK_TCK = 2;
{$EXTERNALSYM _SC_CLK_TCK}
  _SC_MESSAGE_PASSING = 20;
{$EXTERNALSYM _SC_MESSAGE_PASSING}
  _SC_SEMAPHORES = 21;
{$EXTERNALSYM _SC_SEMAPHORES}
  _SC_SHARED_MEMORY_OBJECTS = 22;
{$EXTERNALSYM _SC_SHARED_MEMORY_OBJECTS}
  _SC_AIO_LISTIO_MAX = 23;
{$EXTERNALSYM _SC_AIO_LISTIO_MAX}
  _SC_AIO_MAX = 24;
{$EXTERNALSYM _SC_AIO_MAX}
  _SC_AIO_PRIO_DELTA_MAX = 25;
{$EXTERNALSYM _SC_AIO_PRIO_DELTA_MAX}
  _SC_DELAYTIMER_MAX = 26;
{$EXTERNALSYM _SC_DELAYTIMER_MAX}
  _SC_MQ_OPEN_MAX = 27;
{$EXTERNALSYM _SC_MQ_OPEN_MAX}
  _SC_MQ_PRIO_MAX = 28;
{$EXTERNALSYM _SC_MQ_PRIO_MAX}
  _SC_VERSION = 29;
{$EXTERNALSYM _SC_VERSION}
  _SC_NGROUPS_MAX = 3;
{$EXTERNALSYM _SC_NGROUPS_MAX}
  _SC_PAGESIZE = 30;
{$EXTERNALSYM _SC_PAGESIZE}
  _SC_PAGE_SIZE = 30;
{$EXTERNALSYM _SC_PAGE_SIZE}
  _SC_RTSIG_MAX = 31;
{$EXTERNALSYM _SC_RTSIG_MAX}
  _SC_SEM_NSEMS_MAX = 32;
{$EXTERNALSYM _SC_SEM_NSEMS_MAX}
  _SC_SEM_VALUE_MAX = 33;
{$EXTERNALSYM _SC_SEM_VALUE_MAX}
  _SC_SIGQUEUE_MAX = 34;
{$EXTERNALSYM _SC_SIGQUEUE_MAX}
  _SC_TIMER_MAX = 35;
{$EXTERNALSYM _SC_TIMER_MAX}
  _SC_BC_BASE_MAX = 36;
{$EXTERNALSYM _SC_BC_BASE_MAX}
  _SC_BC_DIM_MAX = 37;
{$EXTERNALSYM _SC_BC_DIM_MAX}
  _SC_BC_SCALE_MAX = 38;
{$EXTERNALSYM _SC_BC_SCALE_MAX}
  _SC_BC_STRING_MAX = 39;
{$EXTERNALSYM _SC_BC_STRING_MAX}
  _SC_OPEN_MAX = 4;
{$EXTERNALSYM _SC_OPEN_MAX}
  _SC_COLL_WEIGHTS_MAX = 40;
{$EXTERNALSYM _SC_COLL_WEIGHTS_MAX}
  _SC_EXPR_NEST_MAX = 42;
{$EXTERNALSYM _SC_EXPR_NEST_MAX}
  _SC_LINE_MAX = 43;
{$EXTERNALSYM _SC_LINE_MAX}
  _SC_RE_DUP_MAX = 44;
{$EXTERNALSYM _SC_RE_DUP_MAX}
  _SC_2_VERSION = 46;
{$EXTERNALSYM _SC_2_VERSION}
  _SC_2_C_BIND = 47;
{$EXTERNALSYM _SC_2_C_BIND}
  _SC_2_C_DEV = 48;
{$EXTERNALSYM _SC_2_C_DEV}
  _SC_2_FORT_DEV = 49;
{$EXTERNALSYM _SC_2_FORT_DEV}
  _SC_STREAM_MAX = 5;
{$EXTERNALSYM _SC_STREAM_MAX}
  _SC_2_FORT_RUN = 50;
{$EXTERNALSYM _SC_2_FORT_RUN}
  _SC_2_SW_DEV = 51;
{$EXTERNALSYM _SC_2_SW_DEV}
  _SC_2_LOCALEDEF = 52;
{$EXTERNALSYM _SC_2_LOCALEDEF}
  _SC_TZNAME_MAX = 6;
{$EXTERNALSYM _SC_TZNAME_MAX}
  _SC_IOV_MAX = 60;
{$EXTERNALSYM _SC_IOV_MAX}
  _SC_THREADS = 67;
{$EXTERNALSYM _SC_THREADS}
  _SC_THREAD_SAFE_FUNCTIONS = 68;
{$EXTERNALSYM _SC_THREAD_SAFE_FUNCTIONS}
  _SC_GETGR_R_SIZE_MAX = 69;
{$EXTERNALSYM _SC_GETGR_R_SIZE_MAX}
  _SC_JOB_CONTROL = 7;
{$EXTERNALSYM _SC_JOB_CONTROL}
  _SC_GETPW_R_SIZE_MAX = 70;
{$EXTERNALSYM _SC_GETPW_R_SIZE_MAX}
  _SC_LOGIN_NAME_MAX = 71;
{$EXTERNALSYM _SC_LOGIN_NAME_MAX}
  _SC_TTY_NAME_MAX = 72;
{$EXTERNALSYM _SC_TTY_NAME_MAX}
  _SC_THREAD_DESTRUCTOR_ITERATIONS = 73;
{$EXTERNALSYM _SC_THREAD_DESTRUCTOR_ITERATIONS}
  _SC_THREAD_KEYS_MAX = 74;
{$EXTERNALSYM _SC_THREAD_KEYS_MAX}
  _SC_THREAD_STACK_MIN = 75;
{$EXTERNALSYM _SC_THREAD_STACK_MIN}
  _SC_THREAD_THREADS_MAX = 76;
{$EXTERNALSYM _SC_THREAD_THREADS_MAX}
  _SC_THREAD_ATTR_STACKADDR = 77;
{$EXTERNALSYM _SC_THREAD_ATTR_STACKADDR}
  _SC_THREAD_ATTR_STACKSIZE = 78;
{$EXTERNALSYM _SC_THREAD_ATTR_STACKSIZE}
  _SC_THREAD_PRIORITY_SCHEDULING = 79;
{$EXTERNALSYM _SC_THREAD_PRIORITY_SCHEDULING}
  _SC_SAVED_IDS = 8;
{$EXTERNALSYM _SC_SAVED_IDS}
  _SC_THREAD_PRIO_INHERIT = 80;
{$EXTERNALSYM _SC_THREAD_PRIO_INHERIT}
  _SC_THREAD_PRIO_PROTECT = 81;
{$EXTERNALSYM _SC_THREAD_PRIO_PROTECT}
  _SC_THREAD_PROCESS_SHARED = 82;
{$EXTERNALSYM _SC_THREAD_PROCESS_SHARED}
  _SC_ATEXIT_MAX = 87;
{$EXTERNALSYM _SC_ATEXIT_MAX}
  _SC_PASS_MAX = 88;
{$EXTERNALSYM _SC_PASS_MAX}
  _SC_XOPEN_VERSION = 89;
{$EXTERNALSYM _SC_XOPEN_VERSION}
  _SC_REALTIME_SIGNALS = 9;
{$EXTERNALSYM _SC_REALTIME_SIGNALS}
  _SC_XOPEN_UNIX = 91;
{$EXTERNALSYM _SC_XOPEN_UNIX}
  _SC_XOPEN_CRYPT = 92;
{$EXTERNALSYM _SC_XOPEN_CRYPT}
  _SC_XOPEN_ENH_I18N = 93;
{$EXTERNALSYM _SC_XOPEN_ENH_I18N}
  _SC_XOPEN_SHM = 94;
{$EXTERNALSYM _SC_XOPEN_SHM}
  _SC_2_CHAR_TERM = 95;
{$EXTERNALSYM _SC_2_CHAR_TERM}
  _SC_2_C_VERSION = 96;
{$EXTERNALSYM _SC_2_C_VERSION}
  _SC_2_UPE = 97;
{$EXTERNALSYM _SC_2_UPE}

  { !libc-ddefs }
  _SC_NPROCESSORS_ONLN = 84;
{$EXTERNALSYM _SC_NPROCESSORS_ONLN}


  { Functions }

function sysconf(name: Integer): LongInt; cdecl; external libc;
{$EXTERNALSYM sysconf}

{ Use getpagesize instead of sysconf(_SC_PAGESIZE) }
function getpagesize: Integer; cdecl; external libc;
{$EXTERNALSYM getpagesize}

function mmap(Addr: Pointer; Len: size_t; Prot: Integer; Flags: Integer; FileDes: Integer; Off: off_t): Pointer; cdecl; external libc;
{$EXTERNALSYM mmap}
function munmap(Addr: Pointer; Len: size_t): Integer; cdecl; external libc;
{$EXTERNALSYM munmap}
function mprotect(Addr: Pointer; Len: size_t; Prot: Integer): Integer; cdecl; external libc;
{$EXTERNALSYM mprotect}
function sched_get_priority_min(Policy: Integer): Integer; cdecl; external libc;
{$EXTERNALSYM sched_get_priority_min}
function sched_get_priority_max(Policy: Integer): Integer; cdecl; external libc;
{$EXTERNALSYM sched_get_priority_max}